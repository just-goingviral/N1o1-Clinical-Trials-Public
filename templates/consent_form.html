
{% extends "base.html" %}
{% block content %}
  <div class="container py-4">
    <div class="card border-0 shadow-sm">
      <div class="card-header bg-primary text-white">
        <h2 class="mb-0">Patient Consent Form</h2>
      </div>
      <div class="card-body p-4">
        <form method="post">
          <p class="mb-4">Please read the consent information and check the boxes to confirm:</p>
          
          {% if patient %}
            <input type="hidden" name="patient_id" value="{{ patient.id }}">
            <div class="alert alert-info">
              <h4 class="alert-heading">Patient Information</h4>
              <p>Name: {{ patient.name or "Unnamed" }}<br>
              ID: {{ patient.id }}<br>
              Age: {{ patient.age }} years</p>
            </div>
          {% else %}
            <div class="mb-3">
              <label for="patient_select" class="form-label">Select Patient:</label>
              <select name="patient_id" id="patient_select" class="form-select" required>
                <option value="">-- Select a patient --</option>
                {% for p in patients %}
                  <option value="{{ p.id }}">{{ p.name or "Unnamed" }} (ID: {{ p.id }})</option>
                {% endfor %}
              </select>
            </div>
          {% endif %}
          
          <div class="mb-3">
            <div class="form-check">
              <input type="checkbox" class="form-check-input" name="understood_risks" id="understood_risks" required>
              <label class="form-check-label" for="understood_risks">
                I understand the risks of participating in this nitric oxide study, including potential side effects of nitric oxide supplementation, monitoring procedures, and the experimental nature of the treatment.
              </label>
            </div>
          </div>
          
          <div class="mb-3">
            <div class="form-check">
              <input type="checkbox" class="form-check-input" name="agreed_to_terms" id="agreed_to_terms" required>
              <label class="form-check-label" for="agreed_to_terms">
                I agree to the terms of the clinical trial, including attending all scheduled visits, following the supplement protocol as prescribed, reporting any adverse effects promptly, and allowing my data to be used for research purposes in accordance with privacy regulations.
              </label>
            </div>
          </div>
          
          <div class="mb-4">
            <label for="signed_name" class="form-label">Your Full Name (as signature):</label>
            <input type="text" class="form-control" name="signed_name" id="signed_name" required>
          </div>
          
          <div class="d-flex justify-content-between">
            <a href="{{ url_for('patients.list_patients') }}" class="btn btn-outline-secondary">
              <i class="fas fa-arrow-left me-1"></i> Back to Patients
            </a>
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-signature me-1"></i> Submit Consent
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
{% endblock %}
